{
    "abstract": "Artificial intelligence workloads, especially transformer models, exhibit emergent sparsity in which computations perform selective sparse access to dense data. The workloads are inefficient on hardware designed for dense computations and do not map well onto sparse data representations. We build a vectorized and parallel matrix-multiplication system A X B = C that eliminates unnecessary computations and avoids branches based on a runtime evaluation of sparsity. We use a combination of dynamic code lookup to adapt to the specific sparsity encoded in the B matrix and preprocessing of sparsity maps of the A and B matrices to compute conditional branches once for the whole computation. For a wide range of sparsity, from 60% to 95% zeros, our implementation performs fewer instructions and increases performance when compared with Intel MKL's dense or sparse matrix multiply routines. Benefits can be as large as 2 times speedup and 4 times fewer instructions.",
    "arxivId": "2402.14118",
    "authors": [
        {
            "authorId": "7645905",
            "name": "Brian Wheatman",
            "url": "https://www.semanticscholar.org/author/7645905"
        },
        {
            "authorId": "50481453",
            "name": "Meghana Madhyastha",
            "url": "https://www.semanticscholar.org/author/50481453"
        },
        {
            "authorId": "2247681588",
            "name": "Randal C. Burns",
            "url": "https://www.semanticscholar.org/author/2247681588"
        }
    ],
    "citationVelocity": 0,
    "citations": [],
    "corpusId": 267782453,
    "doi": "10.48550/arXiv.2402.14118",
    "fieldsOfStudy": [
        "Computer Science"
    ],
    "influentialCitationCount": 0,
    "isOpenAccess": false,
    "isPublisherLicensed": true,
    "is_open_access": false,
    "is_publisher_licensed": true,
    "numCitedBy": 0,
    "numCiting": 23,
    "paperId": "b566b56d2f9365abd2b9b66331a70434b5e1409b",
    "references": [
        {
            "arxivId": null,
            "authors": [
                {
                    "authorId": "145381703",
                    "name": "Stephen Chou"
                },
                {
                    "authorId": "2134745139",
                    "name": "S. Amarasinghe"
                }
            ],
            "doi": "10.1145/3563338",
            "intent": [
                "background"
            ],
            "isInfluential": false,
            "paperId": "1683f4502414992a6f3fc5b1bab1385a88d94fb6",
            "title": "Compilation of dynamic sparse tensor algebra",
            "url": "https://www.semanticscholar.org/paper/1683f4502414992a6f3fc5b1bab1385a88d94fb6",
            "venue": "Proc. ACM Program. Lang.",
            "year": 2022
        },
        {
            "arxivId": "2210.06313",
            "authors": [
                {
                    "authorId": "2142692796",
                    "name": "Zong-xiao Li"
                },
                {
                    "authorId": "1878841",
                    "name": "Chong You"
                },
                {
                    "authorId": "1798880",
                    "name": "Srinadh Bhojanapalli"
                },
                {
                    "authorId": "2108467824",
                    "name": "Daliang Li"
                },
                {
                    "authorId": "2241094",
                    "name": "A. Rawat"
                },
                {
                    "authorId": "1981186",
                    "name": "Sashank J. Reddi"
                },
                {
                    "authorId": "1729504709",
                    "name": "Kenneth Q Ye"
                },
                {
                    "authorId": "70157963",
                    "name": "Felix Chern"
                },
                {
                    "authorId": "2111880653",
                    "name": "Felix X. Yu"
                },
                {
                    "authorId": "37495246",
                    "name": "Ruiqi Guo"
                },
                {
                    "authorId": "49596260",
                    "name": "Surinder Kumar"
                }
            ],
            "doi": null,
            "intent": [
                "background"
            ],
            "isInfluential": false,
            "paperId": "e0271cb75087ccfd4a8c3351e0f5189a6de04c03",
            "title": "The Lazy Neuron Phenomenon: On Emergence of Activation Sparsity in Transformers",
            "url": "https://www.semanticscholar.org/paper/e0271cb75087ccfd4a8c3351e0f5189a6de04c03",
            "venue": "ICLR",
            "year": 2022
        },
        {
            "arxivId": "2205.01068",
            "authors": [
                {
                    "authorId": "2108244542",
                    "name": "Susan Zhang"
                },
                {
                    "authorId": "3849208",
                    "name": "Stephen Roller"
                },
                {
                    "authorId": "39589154",
                    "name": "Naman Goyal"
                },
                {
                    "authorId": "2347956",
                    "name": "Mikel Artetxe"
                },
                {
                    "authorId": "2108267192",
                    "name": "Moya Chen"
                },
                {
                    "authorId": "1782969",
                    "name": "Shuohui Chen"
                },
                {
                    "authorId": "2065332326",
                    "name": "Christopher Dewan"
                },
                {
                    "authorId": "2138579860",
                    "name": "Mona T. Diab"
                },
                {
                    "authorId": "2116235416",
                    "name": "Xian Li"
                },
                {
                    "authorId": "143724481",
                    "name": "Xi Victoria Lin"
                },
                {
                    "authorId": "39980906",
                    "name": "Todor Mihaylov"
                },
                {
                    "authorId": "40511414",
                    "name": "Myle Ott"
                },
                {
                    "authorId": "88728159",
                    "name": "Sam Shleifer"
                },
                {
                    "authorId": "35752280",
                    "name": "Kurt Shuster"
                },
                {
                    "authorId": "2082239112",
                    "name": "Daniel Simig"
                },
                {
                    "authorId": "2146367061",
                    "name": "Punit Singh Koura"
                },
                {
                    "authorId": "5382923",
                    "name": "Anjali Sridhar"
                },
                {
                    "authorId": "1785372925",
                    "name": "Tianlu Wang"
                },
                {
                    "authorId": "1982950",
                    "name": "Luke Zettlemoyer"
                }
            ],
            "doi": null,
            "intent": [],
            "isInfluential": false,
            "paperId": "13a0d8bb38f739990c8cd65a44061c6534f17221",
            "title": "OPT: Open Pre-trained Transformer Language Models",
            "url": "https://www.semanticscholar.org/paper/13a0d8bb38f739990c8cd65a44061c6534f17221",
            "venue": "ArXiv",
            "year": 2022
        },
        {
            "arxivId": "2203.08069",
            "authors": [
                {
                    "authorId": "2069635284",
                    "name": "Rohan Yadav"
                },
                {
                    "authorId": "144653825",
                    "name": "A. Aiken"
                },
                {
                    "authorId": "2290932",
                    "name": "Fredrik Kjolstad"
                }
            ],
            "doi": "10.1145/3519939.3523437",
            "intent": [
                "background"
            ],
            "isInfluential": false,
            "paperId": "07165e4c919d095ae04a82d543146b2e423a5b9c",
            "title": "DISTAL: the distributed tensor algebra compiler",
            "url": "https://www.semanticscholar.org/paper/07165e4c919d095ae04a82d543146b2e423a5b9c",
            "venue": "PLDI",
            "year": 2022
        },
        {
            "arxivId": "2111.12763",
            "authors": [
                {
                    "authorId": "25898662",
                    "name": "Sebastian Jaszczur"
                },
                {
                    "authorId": "2841893",
                    "name": "Aakanksha Chowdhery"
                },
                {
                    "authorId": "1579862074",
                    "name": "Afroz Mohiuddin"
                },
                {
                    "authorId": "40527594",
                    "name": "Lukasz Kaiser"
                },
                {
                    "authorId": "32861932",
                    "name": "Wojciech Gajewski"
                },
                {
                    "authorId": "47407464",
                    "name": "H. Michalewski"
                },
                {
                    "authorId": "2036077",
                    "name": "Jonni Kanerva"
                }
            ],
            "doi": null,
            "intent": [
                "background"
            ],
            "isInfluential": false,
            "paperId": "da0d38cf2ac7e2a6908e0d9e1fff07058daab2ed",
            "title": "Sparse is Enough in Scaling Transformers",
            "url": "https://www.semanticscholar.org/paper/da0d38cf2ac7e2a6908e0d9e1fff07058daab2ed",
            "venue": "NeurIPS",
            "year": 2021
        },
        {
            "arxivId": null,
            "authors": [
                {
                    "authorId": "2143421287",
                    "name": "Yannan Nellie Wu"
                },
                {
                    "authorId": "30901893",
                    "name": "Po-An Tsai"
                },
                {
                    "authorId": "1790421",
                    "name": "A. Parashar"
                },
                {
                    "authorId": "1691305",
                    "name": "V. Sze"
                },
                {
                    "authorId": "1775477",
                    "name": "J. Emer"
                }
            ],
            "doi": "10.1109/ISPASS51385.2021.00043",
            "intent": [
                "background",
                "methodology"
            ],
            "isInfluential": false,
            "paperId": "c48f5b50d931cdcc1de26abd2915313a1258b851",
            "title": "Sparseloop: An Analytical, Energy-Focused Design Space Exploration Methodology for Sparse Tensor Accelerators",
            "url": "https://www.semanticscholar.org/paper/c48f5b50d931cdcc1de26abd2915313a1258b851",
            "venue": "2021 IEEE International Symposium on Performance Analysis of Systems and Software (ISPASS)",
            "year": 2021
        },
        {
            "arxivId": "2101.03961",
            "authors": [
                {
                    "authorId": "26958176",
                    "name": "W. Fedus"
                },
                {
                    "authorId": "2368067",
                    "name": "Barret Zoph"
                },
                {
                    "authorId": "1846258",
                    "name": "Noam M. Shazeer"
                }
            ],
            "doi": null,
            "intent": [
                "background"
            ],
            "isInfluential": false,
            "paperId": "fdacf2a732f55befdc410ea927091cad3b791f13",
            "title": "Switch Transformers: Scaling to Trillion Parameter Models with Simple and Efficient Sparsity",
            "url": "https://www.semanticscholar.org/paper/fdacf2a732f55befdc410ea927091cad3b791f13",
            "venue": "J. Mach. Learn. Res.",
            "year": 2021
        },
        {
            "arxivId": null,
            "authors": [
                {
                    "authorId": "2066632456",
                    "name": "Ryan Senanayake"
                },
                {
                    "authorId": "40372102",
                    "name": "Changwan Hong"
                },
                {
                    "authorId": "2860279",
                    "name": "Ziheng Wang"
                },
                {
                    "authorId": "48678816",
                    "name": "Amalee Wilson"
                },
                {
                    "authorId": "145381703",
                    "name": "Stephen Chou"
                },
                {
                    "authorId": "145683292",
                    "name": "Shoaib Kamil"
                },
                {
                    "authorId": "1709150",
                    "name": "Saman P. Amarasinghe"
                },
                {
                    "authorId": "2290932",
                    "name": "Fredrik Kjolstad"
                }
            ],
            "doi": "10.1145/3428226",
            "intent": [
                "background"
            ],
            "isInfluential": false,
            "paperId": "9734b213e134675187ba569c77276004d8cb3f7c",
            "title": "A sparse iteration space transformation framework for sparse tensor algebra",
            "url": "https://www.semanticscholar.org/paper/9734b213e134675187ba569c77276004d8cb3f7c",
            "venue": "Proc. ACM Program. Lang.",
            "year": 2020
        },
        {
            "arxivId": null,
            "authors": [
                {
                    "authorId": "2792832",
                    "name": "T. Schardl"
                },
                {
                    "authorId": "16521420",
                    "name": "William S. Moses"
                },
                {
                    "authorId": "145372049",
                    "name": "C. Leiserson"
                }
            ],
            "doi": "10.1145/3365655",
            "intent": [
                "methodology"
            ],
            "isInfluential": false,
            "paperId": "38895bf7baca5dc2ebfeaa20eed84e6db004e726",
            "title": "Tapir",
            "url": "https://www.semanticscholar.org/paper/38895bf7baca5dc2ebfeaa20eed84e6db004e726",
            "venue": "ACM Trans. Parallel Comput.",
            "year": 2019
        },
        {
            "arxivId": "1109.3739",
            "authors": [
                {
                    "authorId": "2238795",
                    "name": "A. Bulu\u00e7"
                },
                {
                    "authorId": "145428555",
                    "name": "J. Gilbert"
                }
            ],
            "doi": "10.1137/110848244",
            "intent": [
                "background",
                "methodology"
            ],
            "isInfluential": false,
            "paperId": "8c51cd04be72721166c44f65279f9b9bebf423d1",
            "title": "Parallel Sparse Matrix-Matrix Multiplication and Indexing: Implementation and Experiments",
            "url": "https://www.semanticscholar.org/paper/8c51cd04be72721166c44f65279f9b9bebf423d1",
            "venue": "SIAM J. Sci. Comput.",
            "year": 2011
        },
        {
            "arxivId": null,
            "authors": [
                {
                    "authorId": "1765246",
                    "name": "Chris Lattner"
                },
                {
                    "authorId": "1720525",
                    "name": "Vikram S. Adve"
                }
            ],
            "doi": "10.1109/CGO.2004.1281665",
            "intent": [
                "methodology"
            ],
            "isInfluential": false,
            "paperId": "d755f461dddae76068f401409ba59c85a2436305",
            "title": "LLVM: a compilation framework for lifelong program analysis & transformation",
            "url": "https://www.semanticscholar.org/paper/d755f461dddae76068f401409ba59c85a2436305",
            "venue": "International Symposium on Code Generation and Optimization, 2004. CGO 2004.",
            "year": 2004
        },
        {
            "arxivId": null,
            "authors": [
                {
                    "authorId": "1739800",
                    "name": "F. Gustavson"
                }
            ],
            "doi": "10.1145/355791.355796",
            "intent": [
                "background"
            ],
            "isInfluential": false,
            "paperId": "5f491a183c71b0322b16e4f5dc69538c50db79e0",
            "title": "Two Fast Algorithms for Sparse Matrices: Multiplication and Permuted Transposition",
            "url": "https://www.semanticscholar.org/paper/5f491a183c71b0322b16e4f5dc69538c50db79e0",
            "venue": "TOMS",
            "year": 1978
        },
        {
            "arxivId": null,
            "authors": [
                {
                    "authorId": "1765246",
                    "name": "Chris Lattner"
                }
            ],
            "doi": null,
            "intent": [
                "methodology"
            ],
            "isInfluential": false,
            "paperId": "526f947badedb9a49b86b4502cd41367f4aaf3a6",
            "title": "LLVM: AN INFRASTRUCTURE FOR MULTI-STAGE OPTIMIZATION",
            "url": "https://www.semanticscholar.org/paper/526f947badedb9a49b86b4502cd41367f4aaf3a6",
            "venue": "",
            "year": 2000
        }
    ],
    "s2FieldsOfStudy": [
        {
            "category": "Computer Science",
            "source": "external"
        },
        {
            "category": "Computer Science",
            "source": "s2-fos-model"
        }
    ],
    "title": "Masked Matrix Multiplication for Emergent Sparsity",
    "topics": [],
    "url": "https://www.semanticscholar.org/paper/b566b56d2f9365abd2b9b66331a70434b5e1409b",
    "venue": "arXiv.org",
    "year": 2024
}